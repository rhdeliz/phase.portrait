% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_analysis.R
\name{run_analysis}
\alias{run_analysis}
\title{Run Analysis and Generate Phase Portrait Plots
This function performs an in-depth analysis on a dataset to produce various visualizations, including phase portraits, trajectory plots, and other dynamic plots in phase space. Users can specify different analysis options (standard or fraction-based), save individual or combined plot outputs, and control the granularity of binning and parallel processing.}
\arguments{
\item{df}{A data frame containing the dataset with columns \code{x}, \code{y}, \code{dx}, \code{dy}, \code{x_variable}, \code{y_variable}.}

\item{option}{A character string specifying the analysis type. Options include "all" (default), "standard", or "fraction".}

\item{n_bins}{Integer specifying the number of bins to discretize \code{x} and \code{y} in phase line calculations. Default is 4.}

\item{min_bin_n}{Integer specifying the minimum number of observations required in each bin. Default is 1.}

\item{save_tables}{Logical. If TRUE, saves intermediary data tables generated during analysis. Default is FALSE.}

\item{plot_individual}{Logical. If TRUE, saves each individual plot generated during the analysis. Default is FALSE.}

\item{plot_combined}{Logical. If TRUE, saves combined plots into one file for easy comparison. Default is TRUE.}

\item{n_cores}{Integer specifying the number of cores to use for parallel processing. Default is NULL (auto-detect).}

\item{phase_line_tables}{Character string specifying phase line table output format: "binned", "average", or "all". Default is "all".}
}
\value{
This function saves the generated plots and does not return a value.
}
\description{
Run Analysis and Generate Phase Portrait Plots
This function performs an in-depth analysis on a dataset to produce various visualizations, including phase portraits, trajectory plots, and other dynamic plots in phase space. Users can specify different analysis options (standard or fraction-based), save individual or combined plot outputs, and control the granularity of binning and parallel processing.
}
\details{
The \code{run_analysis} function is designed to process and visualize phase space data comprehensively, providing flexibility for standard and fraction-based representations of the data. The function offers several customizable options for binning, minimum observations per bin, and parallel processing. Users can select to save intermediary data tables, individual plots, or combined plots based on their analysis needs. The main components of this function include:
\itemize{
\item \strong{Phase Space Calculation}: Calls \code{phase_space()} to compute the core phase space dataset, using parallel processing if specified.
\item \strong{Data Preparation for Plotting}: Computes additional summary tables, including \code{pseudotime_trajectory()}, \code{phase_portrait()}, and \code{phase_lines()} based on the selected \code{option}. Both standard and fraction-based versions can be generated, providing an in-depth view of phase space dynamics.
\item \strong{Plot Generation}: Creates various types of plots to visualize dynamics, including:
\itemize{
\item \code{trajectory_plots}: Displays pseudotime trajectories in phase space.
\item \code{all_trajectory_plots}: Shows all sample trajectories over pseudotime.
\item \code{stream_plots}: Displays dynamic phase portrait streams, representing variable changes over time.
\item \code{phase_portrait_plots}: Shows a static view of the phase portrait, summarizing variable interactions.
\item \code{phase_line_plots}: Visualizes phase lines across binned data, providing insights into directional trends.
\item \code{n_plots}: Highlights the observation count within each phase space bin.
}
\item \strong{Fraction-Based Plots}: Mirrors the standard plots but operates on a fraction-based representation of the data, with plot types prefixed by \code{fract_}.
\item \strong{Plot Merging}: If \code{plot_combined} is TRUE, combines selected plots into a single layout for easier comparison and visualization of results, saving it as a single PDF file.
\item \strong{Error Handling}: Each data processing and plotting step is wrapped in error handling, ensuring any issues are reported without halting the entire workflow.
\item \strong{Parallel Processing}: Supports parallel processing with \code{n_cores} to optimize performance for large datasets.
}

This function is well-suited for exploratory data analysis and visual interpretation of phase space dynamics, especially valuable when examining complex systems over time. Enabling \code{save_tables} or \code{plot_individual} can result in multiple file outputs for detailed analysis, while combined plots are saved as a single PDF for convenience.
}
\examples{
# Example usage:
df <- data.frame(x = rnorm(100), y = rnorm(100), dx = rnorm(100), dy = rnorm(100),
                 x_variable = "X Axis", y_variable = "Y Axis")
run_analysis(df, option = "all", n_bins = 4, min_bin_n = 1, save_tables = TRUE, plot_individual = TRUE)
}
